<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
    <script>
      if (window.ethereum) {
        window.web3 = new Web3(ethereum);

        const connect = () => {
          ethereum.enable() // サインインが開く
        }

        const accounts = await web3.eth.getAccounts() // ユーザーのアドレスの配列が取れる

        const sign = async () => {
          const signature = await web3.eth.personal.sign('生成されたメッセージ', accounts[0], '') // 署名できる
          console.log(signature)
        }

        const submit = () => {
          // TODO: [sigunature, contractAddress, tokenID, accounts[0]] をバックエンドに送る
        }
      }
    </script>
  </head>
  <body>
    <!-- walletをコネクトする -->
    <div>
      <button action="connect()">Connect to Metamask</button>
    </div>
    <!-- コネクト後に署名 ボタンじゃなくてもコネクトしたら自動で署名でもいい -->
    <div>
      <button action="sign()">署名する</button>
    </div>
    <!-- 署名後に入力 -->
    <div>
      <div>
        <label>
          contractAddress
          <input name="contractAddress" value="" />
        </label>
      </div>
      <div>
        <label>
          tokenID
          <input name="tokenID" value="" />
        </label>
      </div>

      <button action="submit">送信</button>
    </div>
  </body>
</html>
